<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Vega Strike ~Taose: MeshInterface Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vega Strike ~Taose
   &#160;<span id="projectnumber">Experimental</span>
   </div>
   <div id="projectbrief">VegaStrike-OpenSourceSpaceCombat</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../d2/df6/classMeshInterface-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">MeshInterface Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for MeshInterface:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d71/classMeshInterface__coll__graph.png" border="0" usemap="#MeshInterface_coll__map" alt="Collaboration graph"/></div>
<map name="MeshInterface_coll__map" id="MeshInterface_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a166fa0dd2932406c1662f11308d143f0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a166fa0dd2932406c1662f11308d143f0"></a>
inline_ <a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetNbTriangles</b> () const </td></tr>
<tr class="separator:a166fa0dd2932406c1662f11308d143f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4e57faca3d41acb1e595f221b71769"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9f4e57faca3d41acb1e595f221b71769"></a>
inline_ <a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a>&#160;</td><td class="memItemRight" valign="bottom"><b>GetNbVertices</b> () const </td></tr>
<tr class="separator:a9f4e57faca3d41acb1e595f221b71769"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfd3284e03432fe0fefe895b79df6cdf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abfd3284e03432fe0fefe895b79df6cdf"></a>
inline_ void&#160;</td><td class="memItemRight" valign="bottom"><b>SetNbTriangles</b> (<a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a> nb)</td></tr>
<tr class="separator:abfd3284e03432fe0fefe895b79df6cdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f9a5aae4efcd8d21a174fedbdcbfcf7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5f9a5aae4efcd8d21a174fedbdcbfcf7"></a>
inline_ void&#160;</td><td class="memItemRight" valign="bottom"><b>SetNbVertices</b> (<a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a> nb)</td></tr>
<tr class="separator:a5f9a5aae4efcd8d21a174fedbdcbfcf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4810ebe4cad5b7ff08ca26187fa1c301"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d48/classMeshInterface.html#a4810ebe4cad5b7ff08ca26187fa1c301">SetPointers</a> (const <a class="el" href="../../d3/d86/classIndexedTriangle.html">IndexedTriangle</a> *tris, const <a class="el" href="../../dc/d4f/classPoint.html">Point</a> *verts)</td></tr>
<tr class="separator:a4810ebe4cad5b7ff08ca26187fa1c301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c3594184da578eee7b7163453bf0269"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5c3594184da578eee7b7163453bf0269"></a>
inline_ const <a class="el" href="../../d3/d86/classIndexedTriangle.html">IndexedTriangle</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>GetTris</b> () const </td></tr>
<tr class="separator:a5c3594184da578eee7b7163453bf0269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2ba230f02dbec05b265c31b1f76bed3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac2ba230f02dbec05b265c31b1f76bed3"></a>
inline_ const <a class="el" href="../../dc/d4f/classPoint.html">Point</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>GetVerts</b> () const </td></tr>
<tr class="separator:ac2ba230f02dbec05b265c31b1f76bed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2ce7bb92b4a2825147c33616114f2c1"><td class="memItemLeft" align="right" valign="top">inline_ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d48/classMeshInterface.html#ae2ce7bb92b4a2825147c33616114f2c1">GetTriangle</a> (<a class="el" href="../../da/d54/structVertexPointers.html">VertexPointers</a> &amp;vp, <a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a> index) const </td></tr>
<tr class="separator:ae2ce7bb92b4a2825147c33616114f2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7507e521cb4cd844960dd5e24eba937a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d48/classMeshInterface.html#a7507e521cb4cd844960dd5e24eba937a">RemapClient</a> (<a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a> nb_indices, const <a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a> *permutation) const </td></tr>
<tr class="separator:a7507e521cb4cd844960dd5e24eba937a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28e02f1fa9f6d41523fae3f8649fcdb5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d48/classMeshInterface.html#a28e02f1fa9f6d41523fae3f8649fcdb5">IsValid</a> () const </td></tr>
<tr class="separator:a28e02f1fa9f6d41523fae3f8649fcdb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f3838ddf40b99457039bf161fc2aa7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d48/classMeshInterface.html#a27f3838ddf40b99457039bf161fc2aa7">CheckTopology</a> () const </td></tr>
<tr class="separator:a27f3838ddf40b99457039bf161fc2aa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class is an interface between us and user-defined meshes. Meshes can be defined in a lot of ways, and here we try to support most of them.</p>
<p>Basically you have two options:</p><ul>
<li>callbacks, if OPC_USE_CALLBACKS is defined in <a class="el" href="../../d1/d0f/OPC__Settings_8h.html">OPC_Settings.h</a>.</li>
<li>else pointers.</li>
</ul>
<p>If using pointers, you can also use strides or not. Strides are used when OPC_USE_STRIDE is defined.</p>
<p>CALLBACKS:</p>
<p>Using callbacks is the most generic way to feed OPCODE with your meshes. Indeed, you just have to give access to three vertices at the end of the day. It's up to you to fetch them from your database, using whatever method you want. Hence your meshes can lie in system memory or AGP, be indexed or not, use 16 or 32-bits indices, you can decompress them on-the-fly if needed, etc. On the other hand, a callback is called each time OPCODE needs access to a particular triangle, so there might be a slight overhead.</p>
<p>To make things clear: geometry &amp; topology are NOT stored in the collision system, in order to save some ram. So, when the system needs them to perform accurate intersection tests, you're requested to provide the triangle-vertices corresponding to a given face index.</p>
<p>Ex:</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> ColCallback(<a class="code" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a> triangle_index, <a class="code" href="../../da/d54/structVertexPointers.html">VertexPointers</a>&amp; triangle, <a class="code" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a> user_data)</div><div class="line">{</div><div class="line">    <span class="comment">// Get back Mesh0 or Mesh1 (you also can use 2 different callbacks)</span></div><div class="line">    <a class="code" href="../../d9/d5e/classMesh.html">Mesh</a>* MyMesh = (<a class="code" href="../../d9/d5e/classMesh.html">Mesh</a>*)user_data;</div><div class="line">    <span class="comment">// Get correct triangle in the app-controlled database</span></div><div class="line">    <span class="keyword">const</span> <a class="code" href="../../d2/d51/classTriangle.html">Triangle</a>* <a class="code" href="../../d1/d1f/classTri.html">Tri</a> = MyMesh-&gt;GetTriangle(triangle_index);</div><div class="line">    <span class="comment">// Setup pointers to vertices for the collision system</span></div><div class="line">    triangle.Vertex[0] = MyMesh-&gt;GetVertex(Tri-&gt;mVRef[0]);</div><div class="line">    triangle.Vertex[1] = MyMesh-&gt;GetVertex(Tri-&gt;mVRef[1]);</div><div class="line">    triangle.Vertex[2] = MyMesh-&gt;GetVertex(Tri-&gt;mVRef[2]);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Setup callbacks</span></div><div class="line">MeshInterface0-&gt;SetCallback(ColCallback, <a class="code" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a>(Mesh0));</div><div class="line">MeshInterface1-&gt;SetCallback(ColCallback, <a class="code" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a>(Mesh1));</div></div><!-- fragment --><p>Of course, you should make this callback as fast as possible. And you're also not supposed to modify the geometry <em>after</em> the collision trees have been built. The alternative was to store the geometry &amp; topology in the collision system as well (as in RAPID) but we have found this approach to waste a lot of ram in many cases.</p>
<p>POINTERS:</p>
<p>If you're internally using the following canonical structures:</p><ul>
<li>a vertex made of three 32-bits floating point values</li>
<li>a triangle made of three 32-bits integer vertex references ...then you may want to use pointers instead of callbacks. This is the same, except OPCODE will directly use provided pointers to access the topology and geometry, without using a callback. It might be faster, but probably not as safe. Pointers have been introduced in OPCODE 1.2.</li>
</ul>
<p>Ex:</p>
<div class="fragment"><div class="line"><span class="comment">// Setup pointers</span></div><div class="line">MeshInterface0-&gt;SetPointers(Mesh0-&gt;GetFaces(), Mesh0-&gt;GetVerts());</div><div class="line">MeshInterface1-&gt;SetPointers(Mesh1-&gt;GetFaces(), Mesh1-&gt;GetVerts());</div></div><!-- fragment --><p>STRIDES:</p>
<p>If your vertices are D3D-like entities interleaving a position, a normal and/or texture coordinates (i.e. if your vertices are FVFs), you might want to use a vertex stride to skip extra data OPCODE doesn't need. Using a stride shouldn't be notably slower than not using it, but it might increase cache misses. Please also note that you <em>shouldn't</em> read from AGP or video-memory buffers !</p>
<p>In any case, compilation flags are here to select callbacks/pointers/strides at compile time, so choose what's best for your application. All of this has been wrapped into this <a class="el" href="../../d7/d48/classMeshInterface.html">MeshInterface</a>.</p>
<dl class="section author"><dt>Author</dt><dd>Pierre Terdiman </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.3 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>November, 27, 2002 </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a27f3838ddf40b99457039bf161fc2aa7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a> MeshInterface::CheckTopology </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks the mesh itself is valid. Currently we only look for degenerate faces. </p><dl class="section return"><dt>Returns</dt><dd>number of degenerate faces </dd></dl>

</div>
</div>
<a class="anchor" id="ae2ce7bb92b4a2825147c33616114f2c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">inline_ void MeshInterface::GetTriangle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d54/structVertexPointers.html">VertexPointers</a> &amp;&#160;</td>
          <td class="paramname"><em>vp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a>&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Fetches a triangle given a triangle index. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vp</td><td>[out] required triangle's vertex pointers </td></tr>
    <tr><td class="paramname">index</td><td>[in] triangle index </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a28e02f1fa9f6d41523fae3f8649fcdb5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MeshInterface::IsValid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks the mesh interface is valid, i.e. things have been setup correctly. </p><dl class="section return"><dt>Returns</dt><dd>true if valid </dd></dl>

</div>
</div>
<a class="anchor" id="a7507e521cb4cd844960dd5e24eba937a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MeshInterface::RemapClient </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a>&#160;</td>
          <td class="paramname"><em>nb_indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d54/IceTypes_8h.html#a44c6f1920ba5551225fb534f9d1a1733">udword</a> *&#160;</td>
          <td class="paramname"><em>permutation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remaps client's mesh according to a permutation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nb_indices</td><td>[in] number of indices in the permutation (will be checked against number of triangles) </td></tr>
    <tr><td class="paramname">permutation</td><td>[in] list of triangle indices </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if success </dd></dl>

</div>
</div>
<a class="anchor" id="a4810ebe4cad5b7ff08ca26187fa1c301"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool MeshInterface::SetPointers </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d3/d86/classIndexedTriangle.html">IndexedTriangle</a> *&#160;</td>
          <td class="paramname"><em>tris</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../dc/d4f/classPoint.html">Point</a> *&#160;</td>
          <td class="paramname"><em>verts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pointers control: setups object pointers. Must provide access to faces and vertices for a given object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tris</td><td>[in] pointer to triangles </td></tr>
    <tr><td class="paramname">verts</td><td>[in] pointer to vertices </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if success </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>cmd/collide2/<a class="el" href="../../d2/d1b/OPC__MeshInterface_8h_source.html">OPC_MeshInterface.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
