<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Vega Strike ~Taose: networking/netserver.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vega Strike ~Taose
   &#160;<span id="projectnumber">Experimental</span>
   </div>
   <div id="projectbrief">VegaStrike-OpenSourceSpaceCombat</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_c40ffb3a3854dbc0dc2cc9b22acb75c0.html">networking</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">netserver.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* </span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * modify it under the terms of the GNU General Public License</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * as published by the Free Software Foundation; either version 2</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * of the License, or (at your option) any later version.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * along with this program; if not, write to the Free Software</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">  NetServer - Network Server Interface - written by Stephane Vaxelaire &lt;svax@free.fr&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifndef __NETSERVER_H</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#define __NETSERVER_H</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;config.h&quot;</span> <span class="comment">// for HAVE_ZLIB</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// WARNING : using std::queue gives conflicts under Solaris so we must use std::queue explicitly each time we need to</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;boost/shared_ptr.hpp&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;configxml.h&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;networking/accountsxml.h&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;networking/const.h&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;networking/lowlevel/packet.h&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;networking/lowlevel/netui.h&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;networking/lowlevel/vsnet_socketset.h&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;networking/client.h&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;networking/clientptr.h&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;gfx/quaternion.h&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;cmd/unit_generic.h&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;boost/smart_ptr.hpp&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">struct </span><a class="code" href="../../d2/d7d/structGFXColor.html">GFXColor</a>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">extern</span> <a class="code" href="../../d7/d84/classVegaConfig.html">VegaConfig</a> *vs_config;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//extern VegaSimpleConfig *server_config;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">using</span> std::vector;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// typedef list&lt;Client *&gt;::iterator LI;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">typedef</span> vector&lt;Account *&gt;::iterator VI;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">extern</span> ObjSerial SERVER_NETVERSION;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">struct </span><a class="code" href="../../db/d88/structServerSocket.html">ServerSocket</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">class </span><a class="code" href="../../d8/d83/classSocketSet.html">SocketSet</a>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../d2/d6a/namespaceVsnetDownload.html">VsnetDownload</a> {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">namespace </span>Server {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">class </span>Manager;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  };</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;};</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">class </span><a class="code" href="../../df/d07/classVsnetHTTPSocket.html">VsnetHTTPSocket</a>;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="../../de/de3/classNetServer.html">   67</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../de/de3/classNetServer.html">NetServer</a></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="../../d8/d83/classSocketSet.html">SocketSet</a>       _sock_set;              <span class="comment">// Capsule for select()</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="../../db/d88/structServerSocket.html">ServerSocket</a>*   tcpNetwork;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="../../dc/d75/classSOCKETALT.html">SOCKETALT</a>       *udpNetwork;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="../../d7/d97/classPacket.html">Packet</a>          packet;                 <span class="comment">// Network data packet</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="../../d7/d97/classPacket.html">Packet</a>          packeta;                <span class="comment">// Network data packet for account server</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="../../d2/d93/classSaveGame.html">SaveGame</a>*       globalsave;             <span class="comment">// Savegame class used to save dynamic universe</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordtype">int</span>             nbclients;              <span class="comment">// Active client connections number</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordtype">int</span>             nbaccts;                <span class="comment">// Number of registered accounts</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="../../df/d07/classVsnetHTTPSocket.html">VsnetHTTPSocket</a>*        acct_sock;              <span class="comment">// Connection socket for account server</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordtype">int</span>             keeprun;                <span class="comment">// Tells if we should keep running server</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordtype">int</span>             snapchanged;            <span class="comment">// Tells the snapshot has changed and can be sent</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordtype">int</span>             acctserver;             <span class="comment">// Tells if we use an account server</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment">// If we don&#39;t use an account server:</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordtype">string</span>              server_password;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        timeval             srvtimeout;         <span class="comment">// timer</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        std::queue&lt;int&gt;         unused_players;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">// queue of units added to system but not sent to clients yet.</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        std::vector&lt;UnitContainer&gt; newUnits;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">//      vector&lt;Account *&gt;   Cltacct;            // Client accounts</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        ClientList          allClients;         <span class="comment">// Active TCP and UDP client connections</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        ClientList          discList;           <span class="comment">// Client connections to be disconnected</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        ClientList          logoutList;         <span class="comment">// Client connections that logged out</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keyword">struct </span>WaitListEntry</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;              <span class="keyword">enum</span> EntryTypes{CONNECTING, JUMPING};</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;              EntryTypes type;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;              <span class="keywordtype">bool</span> tcp;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;              ClientPtr t; <span class="comment">// Client connections waiting for login response</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;              <a class="code" href="../../d1/dc1/structAddressIP.html">AddressIP</a> u; <span class="comment">// Client addresses waiting for login response</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        };</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        std::map&lt;string, WaitListEntry&gt; waitList;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        boost::shared_ptr&lt;VsnetDownload::Server::Manager&gt; _downloadManagerServer;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>*                                _downloadSearchDirs[];</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">class </span><a class="code" href="../../d9/d44/classZoneMgr.html">ZoneMgr</a>       *zonemgr;               <span class="comment">// Zones/star systems Manager</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    </div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordtype">bool</span>            updateTimestamps( ClientPtr clt, <a class="code" href="../../d7/d97/classPacket.html">Packet</a> &amp; p);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="comment">//void          loadConfig();                   // Loads configuration from server.xml</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordtype">void</span>            posUpdate( ClientPtr clt);      <span class="comment">// Update a client position</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordtype">void</span>            addClient( ClientPtr clt);      <span class="comment">// Add the client in the game</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordtype">void</span>            chooseShip( ClientPtr clt, <a class="code" href="../../d7/d97/classPacket.html">Packet</a> &amp;p);  <span class="comment">// Client has chosen a ship to fly in.</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordtype">void</span>            localLogin( ClientPtr clt, <a class="code" href="../../d7/d97/classPacket.html">Packet</a> &amp;p);  <span class="comment">// No account server... client will choose a ship.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordtype">bool</span>            loginAccept( <span class="keyword">const</span> std::string &amp;inetbuf, ClientPtr clt, <span class="keywordtype">int</span> newacct, <span class="keywordtype">char</span> flags);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordtype">void</span>            serverTimeInitUDP( ClientPtr clt, <a class="code" href="../../d9/d1e/classNetBuffer.html">NetBuffer</a> &amp;netbuf);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordtype">void</span>            removeClient( ClientPtr clt);       <span class="comment">// Remove the client from the game</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        ClientPtr       newConnection_udp( <span class="keyword">const</span> <a class="code" href="../../d1/dc1/structAddressIP.html">AddressIP</a>&amp; ipadr);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        ClientPtr       newConnection_tcp( );</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordtype">void</span>            checkAcctMsg( <a class="code" href="../../d8/d83/classSocketSet.html">SocketSet</a>&amp; <span class="keyword">set</span> );         <span class="comment">// Check for account server message to receive</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordtype">void</span>            checkMsg( <a class="code" href="../../d8/d83/classSocketSet.html">SocketSet</a>&amp; <span class="keyword">set</span> );             <span class="comment">// Check for network message to receive</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">void</span>            checkKey( <a class="code" href="../../d8/d83/classSocketSet.html">SocketSet</a>&amp; <span class="keyword">set</span>);                      <span class="comment">// Check for keyboard input</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordtype">void</span>            recvMsg_tcp( ClientPtr clt);        <span class="comment">// Receive network messages</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">void</span>            recvMsg_udp( );                 <span class="comment">// Receive network messages</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordtype">void</span>            processPacket( ClientPtr clt, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> cmd, <span class="keyword">const</span> <a class="code" href="../../d1/dc1/structAddressIP.html">AddressIP</a>&amp; ipadr, <a class="code" href="../../d7/d97/classPacket.html">Packet</a>&amp; packet ); <span class="comment">// Process received packet info</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">void</span>            startMsg();                     <span class="comment">// Startup showing text</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordtype">void</span>            disconnect( ClientPtr clt, <span class="keyword">const</span> <span class="keywordtype">char</span>* debug_from_file, <span class="keywordtype">int</span> debug_from_line );      <span class="comment">// Disconnect a client</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordtype">void</span>            logout( ClientPtr clt);         <span class="comment">// Clean disconnect a client</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordtype">void</span>            checkTimedoutClients_udp();     <span class="comment">// Check for timed out clients  </span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        ClientPtr       addNewClient( <a class="code" href="../../dc/d75/classSOCKETALT.html">SOCKETALT</a> &amp;sock );  <span class="comment">// Adds a new client to listen for.</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">void</span>            sendLoginError( ClientPtr clt);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordtype">void</span>            sendLoginAlready( ClientPtr clt);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordtype">void</span>            sendLoginAccept( ClientPtr clt, <a class="code" href="../../d9/dba/classCockpit.html">Cockpit</a> *cp);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">//returns false if unwilling to load star system</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordtype">void</span>            sendLoginUnavailable( ClientPtr clt);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment">// loadCockpit will fail if a cockpit already exists when client state is CONNECTED.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="../../d9/dba/classCockpit.html">Cockpit</a> *       loadCockpit(ClientPtr clt );</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">bool</span>            loadFromSavegame( ClientPtr clt, <a class="code" href="../../d9/dba/classCockpit.html">Cockpit</a> *cp );</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordtype">bool</span>            loadFromNewGame( ClientPtr clt, <a class="code" href="../../d9/dba/classCockpit.html">Cockpit</a> *cp, <span class="keywordtype">string</span> shipname );</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        ClientPtr       getClientFromSerial( ObjSerial serial);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">public</span>:</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="../../de/de3/classNetServer.html">NetServer</a>();</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        ~<a class="code" href="../../de/de3/classNetServer.html">NetServer</a>();</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordtype">void</span>    start( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> ** argv);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordtype">void</span>    save();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordtype">void</span>    broadcast( <a class="code" href="../../d9/d1e/classNetBuffer.html">NetBuffer</a> &amp; netbuf, ObjSerial serial, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone, Cmd command, <span class="keywordtype">bool</span> isTcp );</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordtype">void</span>    broadcastUnit( <a class="code" href="../../df/dd9/classUnit.html">Unit</a>* un, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordtype">void</span>    sendNewUnitQueue();</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">// WEAPON STUFF</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordtype">void</span>    BroadcastCargoUpgrade( ObjSerial sender, ObjSerial buyer, ObjSerial seller, <span class="keyword">const</span> std::string &amp;cargo,</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                            <span class="keywordtype">float</span> price, <span class="keywordtype">float</span> mass, <span class="keywordtype">float</span> volume, <span class="keywordtype">bool</span> mission, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quantity,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                            <span class="keywordtype">int</span> mountOffset, <span class="keywordtype">int</span> subunitOffset, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordtype">void</span>    BroadcastTarget( ObjSerial serial, ObjSerial oldtarg, ObjSerial target, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordtype">void</span>    BroadcastUnfire( ObjSerial serial, <span class="keyword">const</span> vector&lt;int&gt; &amp;weapon_indicies, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordtype">void</span>    BroadcastFire( ObjSerial serial, <span class="keyword">const</span> vector&lt;int&gt; &amp;weapon_indicies, ObjSerial missile_serial, <span class="keywordtype">float</span> energy, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">//void  sendDamages( ObjSerial serial, int zone, string shields, float recharge, char leak, unsigned short ab, unsigned short af, unsigned short al, unsigned short ar, float ppercentage, float spercentage, float amt, Vector &amp; pnt, Vector &amp; normal, GFXColor &amp; color);</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordtype">bool</span>            saveAccount(<span class="keywordtype">int</span> cpnum );</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordtype">void</span>    sendCustom( <span class="keywordtype">int</span> cp, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;cmd, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;args, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;<span class="keywordtype">id</span>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordtype">void</span>    sendDamages( ObjSerial serial, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone, <span class="keywordtype">float</span> hull, <span class="keyword">const</span> <a class="code" href="../../dc/de8/structShield.html">Shield</a> &amp;shields, <span class="keyword">const</span> <a class="code" href="../../d5/d1b/structArmor.html">Armor</a> &amp;armor,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                            <span class="keywordtype">float</span> ppercentage, <span class="keywordtype">float</span> spercentage, <span class="keywordtype">float</span> amt, Vector &amp; pnt, Vector &amp; normal, <a class="code" href="../../d2/d7d/structGFXColor.html">GFXColor</a> &amp; color);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">//void  sendDamages( ObjSerial serial, Vector &amp; pnt, Vector &amp; normal, float amt, GFXColor &amp; color, float phasedamage);</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordtype">void</span>    sendKill( ObjSerial serial, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordtype">void</span>    sendJump( <a class="code" href="../../df/dd9/classUnit.html">Unit</a> * src, <a class="code" href="../../df/dd9/classUnit.html">Unit</a> *jumppoint, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;destination);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordtype">void</span>    sendJumpFinal( ClientPtr clt, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;server, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> port );</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordtype">void</span>    sendForcePosition( ClientPtr clt );</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordtype">void</span>    invalidateSnapshot( ) { snapchanged = 1; }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// DOCKING STUFF</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordtype">void</span>    sendDockAuthorize( ObjSerial serial, ObjSerial utdwserial, <span class="keywordtype">int</span> docknum, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordtype">void</span>    sendDockDeny( ObjSerial serial, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordtype">void</span>    sendUnDock( ObjSerial serial, ObjSerial utdwserial, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> zone);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordtype">void</span>    sendCredits( ObjSerial serial, <span class="keywordtype">float</span> creds);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordtype">void</span>    addUnitCargoSnapshot( <span class="keyword">const</span> <a class="code" href="../../df/dd9/classUnit.html">Unit</a> *un, <a class="code" href="../../d9/d1e/classNetBuffer.html">NetBuffer</a> &amp;netbuf);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordtype">void</span>    sendCargoSnapshot( ObjSerial serial, <span class="keyword">const</span> <a class="code" href="../../db/d87/classUnitCollection.html">UnitCollection</a> &amp;unitlist);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordtype">void</span>    sendMessage(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;from, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;to, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;message, <span class="keywordtype">float</span> delay);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordtype">void</span>    sendCommunication(<a class="code" href="../../df/dd9/classUnit.html">Unit</a> *from, <a class="code" href="../../df/dd9/classUnit.html">Unit</a> *to, <span class="keyword">const</span> <span class="keyword">class</span> <a class="code" href="../../db/df4/classCommunicationMessage.html">CommunicationMessage</a> *c);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordtype">void</span>    sendSaveData( <span class="keywordtype">int</span> cp, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> packetType, <span class="keywordtype">int</span> pos, <span class="keyword">const</span> <span class="keywordtype">string</span> *key,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                              <a class="code" href="../../da/d97/classMission.html">Mission</a> *miss, <span class="comment">// Mission number for objectives.</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">string</span> *strValue, <span class="keyword">const</span> <span class="keywordtype">float</span> *floatValue);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordtype">void</span>    sendMission( <span class="keywordtype">int</span> cp, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> packetType, <span class="keywordtype">string</span> mission, <span class="keywordtype">int</span> pos);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordtype">void</span>    addSystem( <span class="keywordtype">string</span> &amp; sysname, <span class="keywordtype">string</span> &amp; system);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="../../d9/d44/classZoneMgr.html">ZoneMgr</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordtype">void</span>            closeAllSockets();              <span class="comment">// Disconnect all clients for shutdown</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;};</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">//void  str_cat( char *res, char c, char *s);</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="ttc" id="classCommunicationMessage_html"><div class="ttname"><a href="../../db/df4/classCommunicationMessage.html">CommunicationMessage</a></div><div class="ttdef"><b>Definition:</b> communication.h:61</div></div>
<div class="ttc" id="classZoneMgr_html"><div class="ttname"><a href="../../d9/d44/classZoneMgr.html">ZoneMgr</a></div><div class="ttdef"><b>Definition:</b> zonemgr.h:75</div></div>
<div class="ttc" id="namespaceVsnetDownload_html"><div class="ttname"><a href="../../d2/d6a/namespaceVsnetDownload.html">VsnetDownload</a></div><div class="ttdef"><b>Definition:</b> vsnet_dloadenum.cpp:11</div></div>
<div class="ttc" id="classSOCKETALT_html"><div class="ttname"><a href="../../dc/d75/classSOCKETALT.html">SOCKETALT</a></div><div class="ttdef"><b>Definition:</b> vsnet_socket.h:34</div></div>
<div class="ttc" id="structServerSocket_html"><div class="ttname"><a href="../../db/d88/structServerSocket.html">ServerSocket</a></div><div class="ttdef"><b>Definition:</b> vsnet_serversocket.h:29</div></div>
<div class="ttc" id="structArmor_html"><div class="ttname"><a href="../../d5/d1b/structArmor.html">Armor</a></div><div class="ttdoc">Armor values: how much damage armor can withhold before internal damage accrues. </div><div class="ttdef"><b>Definition:</b> unit_armorshield.h:7</div></div>
<div class="ttc" id="structShield_html"><div class="ttname"><a href="../../dc/de8/structShield.html">Shield</a></div><div class="ttdoc">Shielding Struct holding values of current shields. </div><div class="ttdef"><b>Definition:</b> unit_armorshield.h:38</div></div>
<div class="ttc" id="classUnitCollection_html"><div class="ttname"><a href="../../db/d87/classUnitCollection.html">UnitCollection</a></div><div class="ttdef"><b>Definition:</b> collection.h:29</div></div>
<div class="ttc" id="classSaveGame_html"><div class="ttname"><a href="../../d2/d93/classSaveGame.html">SaveGame</a></div><div class="ttdef"><b>Definition:</b> savegame.h:28</div></div>
<div class="ttc" id="classPacket_html"><div class="ttname"><a href="../../d7/d97/classPacket.html">Packet</a></div><div class="ttdef"><b>Definition:</b> packet.h:20</div></div>
<div class="ttc" id="classVegaConfig_html"><div class="ttname"><a href="../../d7/d84/classVegaConfig.html">VegaConfig</a></div><div class="ttdef"><b>Definition:</b> configxml.h:58</div></div>
<div class="ttc" id="classVsnetHTTPSocket_html"><div class="ttname"><a href="../../df/d07/classVsnetHTTPSocket.html">VsnetHTTPSocket</a></div><div class="ttdef"><b>Definition:</b> vsnet_sockethttp.h:18</div></div>
<div class="ttc" id="classNetBuffer_html"><div class="ttname"><a href="../../d9/d1e/classNetBuffer.html">NetBuffer</a></div><div class="ttdef"><b>Definition:</b> netbuffer.h:20</div></div>
<div class="ttc" id="classMission_html"><div class="ttname"><a href="../../da/d97/classMission.html">Mission</a></div><div class="ttdef"><b>Definition:</b> mission.h:434</div></div>
<div class="ttc" id="classNetServer_html"><div class="ttname"><a href="../../de/de3/classNetServer.html">NetServer</a></div><div class="ttdef"><b>Definition:</b> netserver.h:67</div></div>
<div class="ttc" id="structAddressIP_html"><div class="ttname"><a href="../../d1/dc1/structAddressIP.html">AddressIP</a></div><div class="ttdef"><b>Definition:</b> vsnet_address.h:30</div></div>
<div class="ttc" id="classUnit_html"><div class="ttname"><a href="../../df/dd9/classUnit.html">Unit</a></div><div class="ttdef"><b>Definition:</b> unit.h:5</div></div>
<div class="ttc" id="structGFXColor_html"><div class="ttname"><a href="../../d2/d7d/structGFXColor.html">GFXColor</a></div><div class="ttdef"><b>Definition:</b> gfxlib_struct.h:150</div></div>
<div class="ttc" id="classSocketSet_html"><div class="ttname"><a href="../../d8/d83/classSocketSet.html">SocketSet</a></div><div class="ttdef"><b>Definition:</b> vsnet_socketset.h:56</div></div>
<div class="ttc" id="classCockpit_html"><div class="ttname"><a href="../../d9/dba/classCockpit.html">Cockpit</a></div><div class="ttdef"><b>Definition:</b> cockpit_generic.h:34</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
